<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asignación de Turnos - Caviana TACA</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* Estilos básicos */
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
        }
        h1, h2 {
            text-align: center;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .dropdown {
            margin: 20px 0;
            text-align: center;
        }
        select {
            padding: 10px;
            font-size: 16px;
            border-radius: 4px;
            border: 1px solid #ccc;
            background-color: #fff;
            color: #333;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 10px;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
        }
        td {
            background-color: #f9f9f9;
        }
        .active {
            background-color: lightblue;
        }
        .hidden {
            display: none;
        }
        /* Estilo para la navegación */
        nav ul {
            display: flex;
            justify-content: center;
            list-style-type: none;
            padding: 0;
            background-color: #333;
        }
        nav ul li {
            margin: 0 15px;
        }
        nav ul li a {
            color: white;
            text-decoration: none;
            padding: 14px 20px;
            display: block;
        }
        nav ul li a:hover {
            background-color: #575757;
        }

        /* Estilos mejorados para la tabla de horarios */
        .table-container {
            margin: 30px auto;
            width: 80%;
        }

        .table-container table {
            margin: 0 auto;
            width: 100%;
        }

        .table-container select {
            width: 50%;
            padding: 10px;
            font-size: 18px;
            margin-bottom: 20px;
        }

    </style>
</head>
<body>

    <!-- Encabezado -->
    <header>
        <h1>Solución al Problema de Asignación de Turnos - Caviana TACA</h1>
        <nav>
            <ul>
                <li><a href="#descripcion">Descripción del Problema</a></li>
                <li><a href="#horarios">Horarios Generados</a></li>
                <li><a href="#resultados">Resultados Generales</a></li>
                <li><a href="#costos">Análisis de Costos</a></li>
                <li><a href="#conclusiones">Conclusiones</a></li>
            </ul>
        </nav>
    </header>

    <!-- Descripción del Problema -->
    <section id="descripcion" class="container">
        <h2>Descripción del Problema</h2>
        <img src="https://raw.githubusercontent.com/luna-as18/T3-Opti-Column-generation/2039e4fe4104dd615d1b8a3bbd7024cccc8f3348/images/SchedulinDescrption.jpeg" alt="Descripción del problema de asignación de turnos" style="width: 50%; height: auto;">
        <p>El problema planteado consiste en la asignación óptima de turnos para un conjunto de equipos que deben cubrir ciertos requerimientos de personal a lo largo de una semana, dividido en días y franjas horarias. El objetivo es minimizar los costos asociados a la asignación de estos equipos, cumpliendo con restricciones operativas tales como el número mínimo de equipos requeridos en cada franja y día, así como reglas de trabajo que aseguran que los equipos no trabajen más de ciertos días consecutivos ni más de un día durante el fin de semana.</p>
    </section>

    <!-- Horarios Generados -->
    <section id="horarios" class="container">
        <h2>Horarios Generados</h2>
        <p>Selecciona un horario para visualizar los turnos asignados a lo largo de la semana:</p>

        <!-- Lista desplegable para seleccionar el horario -->
        <div class="table-container">
            <label for="horario-select">Selecciona un horario:</label>
            <select id="horario-select">
                <option value="" disabled selected>Elige un horario...</option>
            </select>

            <div id="tables-container"></div>
        </div>
    </section>

    <!-- Resultados Generales -->
<section id="resultados" class="container">
    <h2>Resultados Generales</h2>
    <p>En esta sección se presentan los resultados globales del análisis de asignación de turnos. A continuación, se muestra la distribución de equipos asignados y su relación con los costos asociados.</p>

    <!-- Gráfico de dispersión de Costo vs Equipos -->
    <div class="image-container" style="float: right; width: 50%;">
        <h3>Relación entre Costo y Equipos por Horario</h3>
        <img src="https://raw.githubusercontent.com/luna-as18/T3-Opti-Column-generation/main/images/relacionCostosHorario.png" alt="Relación Costo y Equipos" style="width: 100%; height: auto;">
    </div>
    <p style="float: left; width: 50%; padding-right: 20px;">Este gráfico muestra la relación entre el costo y el número de equipos asignados por cada horario generado. Se observa que, a medida que el costo aumenta, la cantidad de equipos asignados tiende a disminuir, lo que indica una posible compensación entre costo y eficiencia operativa en la asignación de los equipos.</p>
    <div style="clear: both;"></div>

    <!-- Gráfico de distribución por día -->
    <div class="image-container" style="float: left; width: 50%;">
        <h3>Distribución de Estados por Día y Franja</h3>
        <img src="https://raw.githubusercontent.com/luna-as18/T3-Opti-Column-generation/main/images/distriDia.png" alt="Distribución por Día y Franja" style="width: 100%; height: auto;">
    </div>
    <p style="float: right; width: 50%; padding-left: 20px;">Este gráfico de calor presenta la distribución de los estados activos en función de los días de la semana y las franjas horarias. Los días y franjas con mayor actividad se destacan en tonos cálidos, mientras que las franjas más inactivas se muestran en tonos fríos, lo que permite visualizar los picos y valles de operación.</p>
    <div style="clear: both;"></div>

    <!-- Gráfico de actividad por día -->
    <div class="image-container" style="float: right; width: 50%;">
        <h3>Actividad por Día de la Semana</h3>
        <img src="https://raw.githubusercontent.com/luna-as18/T3-Opti-Column-generation/main/images/ActiDiaSem.png" alt="Actividad por Día" style="width: 100%; height: auto;">
    </div>
    <p style="float: left; width: 50%; padding-right: 20px;">Aquí se presenta el total de actividad por día de la semana. Se observa que el martes tiene la mayor cantidad de actividad, mientras que el sábado registra el menor volumen de actividad. Esto puede reflejar las necesidades operativas de la semana laboral frente a los fines de semana.</p>
    <div style="clear: both;"></div>
</section>

    <!-- Análisis de Costos -->
    <section id="costos" class="container">
        <h2>Análisis de Costos</h2>
        <p>Aquí se mostrarán los costos asociados a cada horario generado...</p>
        <!-- Tabla de costos -->
        <table>
            <!-- Contenido de la tabla -->
        </table>
    </section>

    <!-- Conclusiones -->
    <section id="conclusiones" class="container">
        <h2>Conclusiones</h2>
        <p>Aquí puedes incluir las conclusiones obtenidas tras analizar los resultados...</p>
    </section>

    <!-- Scripts -->
    <script>
        // URL del archivo JSON
        const url = 'https://raw.githubusercontent.com/luna-as18/T3-Opti-Column-generation/main/columnas_finales_87.json';

        // Las franjas horarias que corresponden a cada intervalo
        const franjasHorarias = [
            "00 a.m. - 2 a.m.",
            "2 a.m. - 4 a.m.",
            "4 a.m. - 6 a.m.",
            "6 a.m. - 8 a.m.",
            "8 a.m. - 10 a.m.",
            "10 a.m. - 12 m.",
            "12 m. - 2 p.m.",
            "2 p.m. - 4 p.m.",
            "4 p.m. - 6 p.m.",
            "6 p.m. - 8 p.m.",
            "8 p.m. - 10 p.m.",
            "10 p.m. - 00 a.m."
        ];

        // Función para generar la tabla de cada horario
        function generarTablaHorario(horarioData, nombreHorario) {
            const dias = ['Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado', 'Domingo'];
            const table = document.createElement('table');
            const thead = document.createElement('thead');
            const tbody = document.createElement('tbody');
            const container = document.getElementById('tables-container');

            // Crear encabezado
            const headerRow = document.createElement('tr');
            const thHorario = document.createElement('th');
            thHorario.textContent = 'Franja horaria';
            headerRow.appendChild(thHorario);

            dias.forEach(dia => {
                const thDia = document.createElement('th');
                thDia.textContent = dia;
                headerRow.appendChild(thDia);
            });

            thead.appendChild(headerRow);

            // Crear cuerpo de la tabla
            const numFranjas = franjasHorarias.length;  // 12 franjas horarias por día
            for (let i = 0; i < numFranjas; i++) {
                const row = document.createElement('tr');
                const horarioCell = document.createElement('td');
                horarioCell.textContent = franjasHorarias[i];
                row.appendChild(horarioCell);

                for (let j = 0; j < 7; j++) {  // 7 días a la semana
                    const dayCell = document.createElement('td');
                    const index = i + j * numFranjas;
                    dayCell.textContent = horarioData[index];

                    if (horarioData[index] === 1.0) {
                        dayCell.classList.add('active');
                    }
                    row.appendChild(dayCell);
                }

                tbody.appendChild(row);
            }

            table.appendChild(thead);
            table.appendChild(tbody);

            // Crear el contenedor para la tabla y agregar la clase "hidden"
            const tableWrapper = document.createElement('div');
            tableWrapper.classList.add('hidden');
            tableWrapper.appendChild(table);
            tableWrapper.id = `table-${nombreHorario}`;
            container.appendChild(tableWrapper);
        }

        // Función para mostrar la tabla seleccionada
        function mostrarTablaHorario(nombreHorario) {
            // Ocultar todas las tablas
            const tablas = document.querySelectorAll('.hidden');
            tablas.forEach(tabla => tabla.style.display = 'none');

            // Mostrar solo la tabla seleccionada
            const tablaSeleccionada = document.getElementById(`table-${nombreHorario}`);
            if (tablaSeleccionada) {
                tablaSeleccionada.style.display = 'block';
            }
        }

        // Hacer fetch para obtener los datos
        fetch(url)
            .then(response => response.json())
            .then(data => {
                const select = document.getElementById('horario-select');
                
                // Rellenar la lista desplegable con las opciones de horarios
                for (let key in data) {
                    const option = document.createElement('option');
                    option.value = key;
                    option.textContent = key;
                    select.appendChild(option);

                    // Generar cada tabla pero mantenerlas ocultas por defecto
                    generarTablaHorario(data[key], key);
                }

                // Detectar cuando se selecciona un horario
                select.addEventListener('change', function() {
                    const horarioSeleccionado = this.value;
                    mostrarTablaHorario(horarioSeleccionado);
                });
            })
            .catch(error => console.error('Error al obtener los datos:', error));
    </script>

</body>
</html>
